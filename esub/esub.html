<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>eSubmission – pharmaverse examples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logging/logging.html" rel="prev">
<link href="../assets/img/Pharmaverse_examples.png" rel="icon" type="image/png">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5b7ccd8ccb072dd816e2b5ae8cfc7151.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-1a1a05289f7c70694cc1839af3fc047d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en-US"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="../assets/css/style.scss">
<meta property="og:title" content="eSubmission – pharmaverse examples">
<meta property="og:description" content="">
<meta property="og:image" content="https://pharmaverse.github.io/examples/esub/ADRG.png">
<meta property="og:site_name" content="pharmaverse examples">
<meta property="og:image:height" content="298">
<meta property="og:image:width" content="790">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">pharmaverse examples</span>
    </a>
  </div>
          <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://pharmaverse.github.io/examples/"> <i class="bi bi-house" role="img" aria-label="pharmaverse">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://app.slack.com/client/T028PB489D3/"> <i class="bi bi-slack" role="img" aria-label="Slack">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pharmaverse/examples"> <i class="bi bi-github" role="img" aria-label="Repository">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
            <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../esub/esub.html">eSubmission</a></li><li class="breadcrumb-item"><a href="../esub/esub.html">eSubmission</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/img/Pharmaverse_examples.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">SDTM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sdtm/examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SDTM Examples</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">ADaM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/adsl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADSL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/adpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/adppk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADPPK</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/adrs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADRS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/adtte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADTTE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/advs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADVS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../adam/adae.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADAE</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">TLG</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tlg/demographic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Demographic Table</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tlg/adverse_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adverse Events</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tlg/pharmacokinetic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pharmacokinetic</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Interactive</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../interactive/teal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>teal</code> applications</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Logs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../logging/logging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Difference Between <code>logr</code>, <code>logrx</code>, and <code>whirl</code></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">eSubmission</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../esub/esub.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">eSubmission</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Info</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://pharmaverse.org/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pharmaverse Home</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page-right" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../esub/esub.html">eSubmission</a></li><li class="breadcrumb-item"><a href="../esub/esub.html">eSubmission</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">eSubmission</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This article shares learnings from R and open source based submission experiences, and how these can be achieved using pharmaverse packages in conjunction.</p>
<p>When considering such a submission, it is important to discuss this early on with the regulatory agency during any pre-submission correspondence.</p>
<p>The main pharmaverse packages specifically supporting eSubmission are as follows:</p>
<ul>
<li>
<a href="https://atorus-research.github.io/xportr/"><code>{xportr}</code></a>: delivers the SAS transport file (XPT) and eSub checks.</li>
<li>
<a href="https://merck.github.io/pkglite/"><code>{pkglite}</code></a>: enables exchange of closed source R packages via text files.</li>
<li>
<a href="https://atorus-research.github.io/datasetjson/"><code>{datasetjson}</code></a>: experimental package to deliver Dataset-JSON.</li>
</ul>
<p>Note that a python equivalent of <a href="https://merck.github.io/pkglite/">pkglite</a> also exists, read more at <a href="https://pharmaverse.org/e2eclinical/python/">pharmaverse python</a>.</p>
<p>Of course, most of the pharmaverse packages contribute to eSubmission in some way, through their focus on enabling clinical reporting and analyses deliverables that form the backbone of any submission. There are many other examples on this site dedicated to these, so we won’t repeat here. One package we did want to call out here is <a href="https://pharmaverse.github.io/aNCA/"><code>{aNCA}</code></a> which performs Non-Compartmental Analysis, as clinical pharmacology analyses are another important part of submissions.</p>
</section><section id="r-submissions-working-group" class="level2"><h2 class="anchored" data-anchor-id="r-submissions-working-group">R Submissions Working Group</h2>
<p>Within the R Consortium, the R Submissions WG have conducted several pilots to provide open examples of submitting R-based clinical trial data/analysis packages to the FDA.</p>
<p>Anyone new to R-based submissions should definitely check out the open materials from this team <a href="https://rconsortium.github.io/submissions-wg/">here</a>.</p>
<p>Since these pilots laid the foundation, several major pharma companies have submitted primarily using R to health authorities across the world, so this article includes a mix of learnings from the pilots and real submissions.</p>
</section><section id="submission-contents" class="level2"><h2 class="anchored" data-anchor-id="submission-contents">Submission Contents</h2>
<p>The areas of eSubmission that pharmaverse packages are most useful for would be data, readable code, and documentation.</p>
<p>Each of the sections below talk in more detail of these areas, plus specific mention of validation which is a common topic raised around usage of open source.</p>
<section id="data" class="level3"><h3 class="anchored" data-anchor-id="data">Data</h3>
<p>The main 2 forms of dataset for CDISC clinical trial submission are SDTM and ADaM. Refer to the separate example articles on this site for how best to go about producing these.</p>
<p>For eSubmission the most common transport file format used to deliver these to health authorities is as xpt files, and for this we use <a href="https://atorus-research.github.io/xportr/">xportr</a>. This package works well with <a href="https://atorus-research.github.io/metacore/">metacore</a> harmonized specification objects as shown in the ADaM articles on this site.</p>
<p>Here is an example call using a synthetic <code>ADSL</code> ADaM from <a href="https://pharmaverse.github.io/pharmaverseadam/">pharmaverseadam</a> that shows how to produce xpt files, as well as how certain <a href="https://atorus-research.github.io/xportr/">xportr</a> functions can be used to take attributes directly from specifications so as to ensure specification to dataset consistency. This helps to ensure eSubmission-readiness. Additionally the package includes a number of built-in CDISC conformance checks as detailed on the <a href="https://atorus-research.github.io/xportr/">site</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(metacore)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(xportr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(pharmaverseadam)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># Read in metacore object</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>metacore <span class="ot">&lt;-</span> <span class="fu">spec_to_metacore</span>(</span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="at">path =</span> <span class="st">"./metadata/safety_specs.xlsx"</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="co"># All datasets are described in the same sheet</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="at">where_sep_sheet =</span> <span class="cn">FALSE</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="fu">select_dataset</span>(<span class="st">"ADSL"</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a>dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>() <span class="co"># Specify the directory for saving the XPT file</span></span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>adsl <span class="ot">&lt;-</span> pharmaverseadam<span class="sc">::</span>adsl <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="co"># Coerce variable type to match specification</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="fu">xportr_type</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="co"># Assigns variable label from metacore specifications</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="fu">xportr_label</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="co"># Assigns dataset label from metacore specifications</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="fu">xportr_df_label</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="co"># Assigns SAS length from a variable level metadata</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="fu">xportr_length</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>  <span class="co"># Assigns variable format from metacore specifications</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>  <span class="fu">xportr_format</span>(<span class="at">metadata =</span> metacore) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>  <span class="co"># Write xpt v5 transport file</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="fu">xportr_write</span>(<span class="fu">file.path</span>(dir, <span class="st">"adsl.xpt"</span>), <span class="at">metadata =</span> metacore, <span class="at">domain =</span> <span class="st">"ADSL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># We can examine that the attributes have been correctly applied, for example</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># as follows for the dataset label</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">attr</span>(adsl, <span class="st">"label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Subject-Level Analysis Dataset"</code></pre>
</div>
</div>
<p>Now here’s an example where the checks would help to identify future possible eSubmission challenges. Note the console messages explaining the issues.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>adsl_challenges <span class="ot">&lt;-</span> pharmaverseadam<span class="sc">::</span>adsl <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="co"># Make a numeric variable as character, which conflicts with specifications</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">mutate</span>(<span class="at">AGE =</span> <span class="fu">as.character</span>(AGE)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="co"># Add a variable that is name &gt;8 characters which is not allowed for xpt v5</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">mutate</span>(<span class="at">REGIONCAT =</span> REGION1)</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>adsl_challenges <span class="ot">&lt;-</span> adsl_challenges <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="co"># Coerce variable type to match specification</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="co"># This time we use the verbose argument to add a warning to the console</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">xportr_type</span>(metacore, <span class="at">verbose =</span> <span class="st">"warn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="co"># Write xpt v5 transport file</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">xportr_write</span>(<span class="fu">file.path</span>(dir, <span class="st">"adsl.xpt"</span>), <span class="at">metadata =</span> metacore, <span class="at">domain =</span> <span class="st">"ADSL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Variable type mismatches found. ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 1 variable coerced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Variable type(s) in dataframe don't match metadata: `AGE`
- `AGE` was coerced to &lt;numeric&gt;. (type in data: character, type in metadata: integer)
i Types in metadata considered as character (xportr.character_metadata_types option): 'character', 'char', 'text', 'date', 'posixct', 'posixt', 'datetime', 'time', 'partialdate', 'partialtime', 'partialdatetime', 'incompletedatetime', 'durationdatetime', and 'intervaldatetime'
i Types in metadata considered as numeric (xportr.numeric_metadata_types option): 'integer', 'numeric', 'num', and 'float'
i Types in data considered as character (xportr.character_types option): 'character'
i Types in data considered as numeric (xportr.numeric_types option): 'integer', 'float', 'numeric', 'posixct', 'posixt', 'time', 'date', and 'hms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following validation checks failed:
• Variable `REGIONCAT` must be 8 characters or less.</code></pre>
</div>
</div>
<p>Furthermore, the package functions also include certain arguments that you can use to help shape to your specific submission needs.</p>
<p>The below shows how some specific FDA requirements can be achieved using the <code>length_source</code> argument from <code><a href="https://atorus-research.github.io/xportr/reference/xportr_length.html">xportr::xportr_length()</a></code> and the <code>max_size_gb</code> argument from <code><a href="https://atorus-research.github.io/xportr/reference/xportr_write.html">xportr::xportr_write()</a></code>, as detailed in the code comments. In this case, the dataset splits would be very unlikely to occur in practice for <code>ADSL</code> but would be much more likely on a BDS dataset such as <code>ADLB</code> for a large study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>adsl_example <span class="ot">&lt;-</span> pharmaverseadam<span class="sc">::</span>adsl <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="co"># Coerce variable type to match specification</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">xportr_type</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="co"># Assigns variable label from metacore specifications</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">xportr_label</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="co"># Assigns dataset label from metacore specifications</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">xportr_df_label</span>(metacore) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="co"># Assigns length from the maximum length of any value of the variable as per FDA data minimisation guidance</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">xportr_length</span>(<span class="at">metadata =</span> metacore, <span class="at">length_source =</span> <span class="st">"data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="co"># Assigns variable format from metacore specifications</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">xportr_format</span>(<span class="at">metadata =</span> metacore) <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="co"># Write xpt v5 transport file but split into smaller subsets if greater than 5GB</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="co"># according to the FDA cutoff size</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">xportr_write</span>(<span class="fu">file.path</span>(dir, <span class="st">"adsl.xpt"</span>), <span class="at">metadata =</span> metacore, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">max_size_gb =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Variable labels missing from metadata. ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 13 labels skipped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Variable length is shorter than the length specified in the metadata. ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Variable lengths missing from metadata. ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ 13 lengths resolved `RFSTDTC`, `RFENDTC`, `RFXSTDTC`, `RFXENDTC`, `RFICDTC`, `RFPENDTC`, `DMDTC`, `DMDY`, `LSTALVDT`, `LDDTHGR1`, `DTH30FL`, `DTHA30FL`, and `DTHB30FL`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Data frame exported to 1 xpt files.</code></pre>
</div>
</div>
<p>As an alternative to xpt, we also have <a href="https://atorus-research.github.io/datasetjson/">datasetjson</a> which enables the emerging new submission data exchange standard Dataset-JSON detailed <a href="https://www.cdisc.org/standards/data-exchange/dataset-json">here</a>. As this package is still experimental, we don’t include code examples here but over time and as momentum grows we can add extra examples to this article. See R Submissions WG <a href="https://rconsortium.github.io/submissions-pilot5-website/">pilot 5</a> for a pilot submission using Dataset-JSON.</p>
</section><section id="readable-code" class="level3"><h3 class="anchored" data-anchor-id="readable-code">Readable Code</h3>
<p>When using internal company-specific closed source tools and codebases, we often face challenges around providing readable code to health authorities as internal single company solutions are by nature not easily accessible and understandable. This is one of the benefits of using open source codebases in the submission setting as it enables review teams to look deeper into the functions used, plus they have the same open solutions available to use themselves as part of their review. As more of the industry embraces open source, we may even see more harmonization of submission packages across the industry as the same packages are re-used, and this should lead to greater familiarity from review teams easing their critical submission dossier review.</p>
<p>The nature of R packages and functions, as well as influence from <a href="https://tidyverse.tidyverse.org">tidyverse</a>, has encouraged most pharmaverse package development teams to embrace modular strategy to their code. So when you use packages like <a href="https://pharmaverse.github.io/admiral/">admiral</a>, you’ll see that the ADaM templates have been built with readability in mind specifically to aid with eSubmission.</p>
</section><section id="documentation" class="level3"><h3 class="anchored" data-anchor-id="documentation">Documentation</h3>
<p>When using R for submission there are some important recommendations around documentation you should include as part of the eSubmission package. Most companies include these in the Reviewer’s Guide documents (<em>the PHUSE Advance Hub offers example templates for these</em>), but you might also choose to use a programTOC document.</p>
<p>Here’s the information we recommend including:</p>
<ul>
<li>R version used</li>
<li>Descriptions of the main open source R package used, the version of each that you used, and where these are available from (especially if anywhere other than CRAN)</li>
<li>Descriptions of any closed source packages used (see details below)</li>
<li>Basic installation instructions of the R version used and how to install the package versions that you used (e.g.&nbsp;from CRAN). The R installation instructions should cover installation from Windows.</li>
</ul>
<p>Here is an example extract of what the documentation of the open source packages used might look like:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="ADRG.png" class="img-fluid figure-img"></p>
<figcaption>Example Reviewer’s Guide Table</figcaption></figure>
</div>
<p>For closed source packages, if you plan to submit the code then there are 2 main options - <a href="https://merck.github.io/pkglite/">pkglite</a> to create txt files, or zip files (as were successfully used in later R Submission WG pilots).</p>
<p>Here is an example taken from the R Submission WG pilot 1 around how they used <code><a href="https://merck.github.io/pkglite/reference/pack.html">pkglite::pack()</a></code> to provide packages as txt files. On the other side <code><a href="https://merck.github.io/pkglite/reference/unpack.html">pkglite::unpack()</a></code> could then be used to unpack.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(pkglite)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co"># Using pkglite to pack proprietary R package and saved into ectd/r0pkg.txt</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>path<span class="sc">$</span>home <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">collate</span>(<span class="fu">file_ectd</span>(), <span class="fu">file_auto</span>(<span class="st">"inst"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">prune</span>(<span class="st">"R/zzz.R"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">pack</span>(<span class="at">output =</span> <span class="st">"ectd/r0pkg.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also check the following example Reviewer’s Guides as used for these pilots:</p>
<ul>
<li>
<a href="https://github.com/RConsortium/submissions-pilot1-to-fda/blob/main/m5/datasets/rconsortiumpilot1/analysis/adam/datasets/adrg.pdf">Pilot 1</a>, using <a href="https://merck.github.io/pkglite/">pkglite</a>
</li>
<li>
<a href="https://github.com/RConsortium/submissions-pilot3-adam-to-fda/blob/main/m5/datasets/rconsortiumpilot3/analysis/adam/datasets/adrg.pdf">Pilot 3</a>, using compressed .zip approach</li>
</ul>
<p>For further Reviewer’s Guide guidance, regardless of the programming language used for regulatory submissions, refer to the completion guidelines found at this <a href="https://advance.hub.phuse.global/wiki/spaces/WEL/pages/26804660/Analysis+Data+Reviewer+s+Guide+ADRG+Package">PHUSE ADRG Package WG</a>. As we progress on this open source submission journey, it is worth monitoring this <a href="https://phuse-org.github.io/OSDocuMeta/">PHUSE Open-Source Metadata Documentation WG</a> to see how the guidance continues to evolve in this space.</p>
</section><section id="validation" class="level3"><h3 class="anchored" data-anchor-id="validation">Validation</h3>
<p>Last but not least, through the submission process you might be asked to provide evidence of why you consider the open source code used to be accurate and reliable.</p>
<p>This of course is a huge topic and one where you should first refer to guidance from the <a href="https://www.pharmar.org/">R Validation Hub</a>.</p>
<p>Pharmaverse also offers a selection of recommended packages that can help with this via our <a href="https://pharmaverse.org/e2eclinical/developers/">Developers page</a> under Package Validation. Under CI/CD it also offers <code>thevalidatoR</code> which is a GitHub action that can be used to produce standardised validation reports, such as this <a href="https://github.com/insightsengineering/thevalidatoR/blob/main/readme_files/report-0.1-admiral.pdf">example</a> from an earlier version of <a href="https://pharmaverse.github.io/admiral/">admiral</a>.</p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pharmaverse\.github\.io\/examples\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-page-right"><div class="nav-page nav-page-previous">
      <a href="../logging/logging.html" class="pagination-link" aria-label="The Difference Between `logr`, `logrx`, and `whirl`">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">The Difference Between <code>logr</code>, <code>logrx</code>, and <code>whirl</code></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb24" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">---</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="an">title:</span><span class="co"> "eSubmission"</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">---</span></span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="fu">## Introduction</span></span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a>This article shares learnings from R and open source based submission experiences,</span>
<span id="cb24-8"><a href="#cb24-8"></a>and how these can be achieved using pharmaverse packages in conjunction.</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a>When considering such a submission, it is important to discuss this early on</span>
<span id="cb24-11"><a href="#cb24-11"></a>with the regulatory agency during any pre-submission correspondence.</span>
<span id="cb24-12"><a href="#cb24-12"></a></span>
<span id="cb24-13"><a href="#cb24-13"></a>The main pharmaverse packages specifically supporting eSubmission are as follows: </span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`{xportr}`</span><span class="co">](https://atorus-research.github.io/xportr/)</span>: delivers the SAS transport file (XPT) and eSub checks.</span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`{pkglite}`</span><span class="co">](https://merck.github.io/pkglite/)</span>: enables exchange of closed source R packages via text files.</span>
<span id="cb24-17"><a href="#cb24-17"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`{datasetjson}`</span><span class="co">](https://atorus-research.github.io/datasetjson/)</span>: experimental package to deliver Dataset-JSON.</span>
<span id="cb24-18"><a href="#cb24-18"></a></span>
<span id="cb24-19"><a href="#cb24-19"></a>Note that a python equivalent of <span class="in">`{pkglite}`</span> also exists, read more at <span class="co">[</span><span class="ot">pharmaverse python</span><span class="co">](https://pharmaverse.org/e2eclinical/python/)</span>.</span>
<span id="cb24-20"><a href="#cb24-20"></a></span>
<span id="cb24-21"><a href="#cb24-21"></a>Of course, most of the pharmaverse packages contribute to eSubmission in some way,</span>
<span id="cb24-22"><a href="#cb24-22"></a>through their focus on enabling clinical reporting and analyses deliverables that</span>
<span id="cb24-23"><a href="#cb24-23"></a>form the backbone of any submission. There are many other examples on this site</span>
<span id="cb24-24"><a href="#cb24-24"></a>dedicated to these, so we won't repeat here. One package we did want to call out</span>
<span id="cb24-25"><a href="#cb24-25"></a>here is <span class="co">[</span><span class="ot">`{aNCA}`</span><span class="co">](https://pharmaverse.github.io/aNCA/)</span> which performs</span>
<span id="cb24-26"><a href="#cb24-26"></a>Non-Compartmental Analysis, as clinical pharmacology analyses are another</span>
<span id="cb24-27"><a href="#cb24-27"></a>important part of submissions.</span>
<span id="cb24-28"><a href="#cb24-28"></a></span>
<span id="cb24-29"><a href="#cb24-29"></a><span class="fu">## R Submissions Working Group</span></span>
<span id="cb24-30"><a href="#cb24-30"></a></span>
<span id="cb24-31"><a href="#cb24-31"></a>Within the R Consortium, the R Submissions WG have conducted several pilots to</span>
<span id="cb24-32"><a href="#cb24-32"></a>provide open examples of submitting R-based clinical trial data/analysis packages</span>
<span id="cb24-33"><a href="#cb24-33"></a>to the FDA.</span>
<span id="cb24-34"><a href="#cb24-34"></a></span>
<span id="cb24-35"><a href="#cb24-35"></a>Anyone new to R-based submissions should definitely check out the open materials</span>
<span id="cb24-36"><a href="#cb24-36"></a>from this team <span class="co">[</span><span class="ot">here</span><span class="co">](https://rconsortium.github.io/submissions-wg/)</span>.</span>
<span id="cb24-37"><a href="#cb24-37"></a></span>
<span id="cb24-38"><a href="#cb24-38"></a>Since these pilots laid the foundation, several major pharma companies have</span>
<span id="cb24-39"><a href="#cb24-39"></a>submitted primarily using R to health authorities across the world, so this</span>
<span id="cb24-40"><a href="#cb24-40"></a>article includes a mix of learnings from the pilots and real submissions.</span>
<span id="cb24-41"><a href="#cb24-41"></a></span>
<span id="cb24-42"><a href="#cb24-42"></a><span class="fu">## Submission Contents</span></span>
<span id="cb24-43"><a href="#cb24-43"></a></span>
<span id="cb24-44"><a href="#cb24-44"></a>The areas of eSubmission that pharmaverse packages are most useful for would be</span>
<span id="cb24-45"><a href="#cb24-45"></a>data, readable code, and documentation.</span>
<span id="cb24-46"><a href="#cb24-46"></a></span>
<span id="cb24-47"><a href="#cb24-47"></a>Each of the sections below talk in more detail of these areas, plus specific</span>
<span id="cb24-48"><a href="#cb24-48"></a>mention of validation which is a common topic raised around usage of open</span>
<span id="cb24-49"><a href="#cb24-49"></a>source.</span>
<span id="cb24-50"><a href="#cb24-50"></a></span>
<span id="cb24-51"><a href="#cb24-51"></a><span class="fu">### Data</span></span>
<span id="cb24-52"><a href="#cb24-52"></a></span>
<span id="cb24-53"><a href="#cb24-53"></a>The main 2 forms of dataset for CDISC clinical trial submission are SDTM and</span>
<span id="cb24-54"><a href="#cb24-54"></a>ADaM. Refer to the separate example articles on this site for how best to go</span>
<span id="cb24-55"><a href="#cb24-55"></a>about producing these.</span>
<span id="cb24-56"><a href="#cb24-56"></a></span>
<span id="cb24-57"><a href="#cb24-57"></a>For eSubmission the most common transport file format used to deliver these to</span>
<span id="cb24-58"><a href="#cb24-58"></a>health authorities is as xpt files, and for this we use <span class="in">`{xportr}`</span>. This package</span>
<span id="cb24-59"><a href="#cb24-59"></a>works well with <span class="in">`{metacore}`</span> harmonized specification objects as shown in the</span>
<span id="cb24-60"><a href="#cb24-60"></a>ADaM articles on this site.</span>
<span id="cb24-61"><a href="#cb24-61"></a></span>
<span id="cb24-62"><a href="#cb24-62"></a>Here is an example call using a synthetic <span class="in">`ADSL`</span> ADaM from <span class="in">`{pharmaverseadam}`</span></span>
<span id="cb24-63"><a href="#cb24-63"></a>that shows how to produce xpt files, as well as how certain <span class="in">`{xportr}`</span></span>
<span id="cb24-64"><a href="#cb24-64"></a>functions can be used to take attributes directly from specifications so as</span>
<span id="cb24-65"><a href="#cb24-65"></a>to ensure specification to dataset consistency. This helps to ensure</span>
<span id="cb24-66"><a href="#cb24-66"></a>eSubmission-readiness. Additionally the package includes a number of built-in</span>
<span id="cb24-67"><a href="#cb24-67"></a>CDISC conformance checks as detailed on the</span>
<span id="cb24-68"><a href="#cb24-68"></a><span class="co">[</span><span class="ot">site</span><span class="co">](https://atorus-research.github.io/xportr/)</span>.</span>
<span id="cb24-69"><a href="#cb24-69"></a></span>
<span id="cb24-70"><a href="#cb24-70"></a><span class="in">```{r clean, message=FALSE, warning=FALSE, results='hold'}</span></span>
<span id="cb24-71"><a href="#cb24-71"></a><span class="in">library(metacore)</span></span>
<span id="cb24-72"><a href="#cb24-72"></a><span class="in">library(xportr)</span></span>
<span id="cb24-73"><a href="#cb24-73"></a><span class="in">library(pharmaverseadam)</span></span>
<span id="cb24-74"><a href="#cb24-74"></a><span class="in">library(dplyr)</span></span>
<span id="cb24-75"><a href="#cb24-75"></a></span>
<span id="cb24-76"><a href="#cb24-76"></a><span class="in"># Read in metacore object</span></span>
<span id="cb24-77"><a href="#cb24-77"></a><span class="in">metacore &lt;- spec_to_metacore(</span></span>
<span id="cb24-78"><a href="#cb24-78"></a><span class="in">  path = "./metadata/safety_specs.xlsx",</span></span>
<span id="cb24-79"><a href="#cb24-79"></a><span class="in">  # All datasets are described in the same sheet</span></span>
<span id="cb24-80"><a href="#cb24-80"></a><span class="in">  where_sep_sheet = FALSE</span></span>
<span id="cb24-81"><a href="#cb24-81"></a><span class="in">) %&gt;%</span></span>
<span id="cb24-82"><a href="#cb24-82"></a><span class="in">  select_dataset("ADSL")</span></span>
<span id="cb24-83"><a href="#cb24-83"></a></span>
<span id="cb24-84"><a href="#cb24-84"></a><span class="in">dir &lt;- tempdir() # Specify the directory for saving the XPT file</span></span>
<span id="cb24-85"><a href="#cb24-85"></a></span>
<span id="cb24-86"><a href="#cb24-86"></a><span class="in">adsl &lt;- pharmaverseadam::adsl %&gt;%</span></span>
<span id="cb24-87"><a href="#cb24-87"></a><span class="in">  # Coerce variable type to match specification</span></span>
<span id="cb24-88"><a href="#cb24-88"></a><span class="in">  xportr_type(metacore) %&gt;%</span></span>
<span id="cb24-89"><a href="#cb24-89"></a><span class="in">  # Assigns variable label from metacore specifications</span></span>
<span id="cb24-90"><a href="#cb24-90"></a><span class="in">  xportr_label(metacore) %&gt;%</span></span>
<span id="cb24-91"><a href="#cb24-91"></a><span class="in">  # Assigns dataset label from metacore specifications</span></span>
<span id="cb24-92"><a href="#cb24-92"></a><span class="in">  xportr_df_label(metacore) %&gt;%</span></span>
<span id="cb24-93"><a href="#cb24-93"></a><span class="in">  # Assigns SAS length from a variable level metadata</span></span>
<span id="cb24-94"><a href="#cb24-94"></a><span class="in">  xportr_length(metacore) %&gt;%</span></span>
<span id="cb24-95"><a href="#cb24-95"></a><span class="in">  # Assigns variable format from metacore specifications</span></span>
<span id="cb24-96"><a href="#cb24-96"></a><span class="in">  xportr_format(metadata = metacore) %&gt;%</span></span>
<span id="cb24-97"><a href="#cb24-97"></a><span class="in">  # Write xpt v5 transport file</span></span>
<span id="cb24-98"><a href="#cb24-98"></a><span class="in">  xportr_write(file.path(dir, "adsl.xpt"), metadata = metacore, domain = "ADSL")</span></span>
<span id="cb24-99"><a href="#cb24-99"></a><span class="in">```</span></span>
<span id="cb24-100"><a href="#cb24-100"></a></span>
<span id="cb24-101"><a href="#cb24-101"></a><span class="in">```{r label}</span></span>
<span id="cb24-102"><a href="#cb24-102"></a><span class="in"># We can examine that the attributes have been correctly applied, for example</span></span>
<span id="cb24-103"><a href="#cb24-103"></a><span class="in"># as follows for the dataset label</span></span>
<span id="cb24-104"><a href="#cb24-104"></a><span class="in">attr(adsl, "label")</span></span>
<span id="cb24-105"><a href="#cb24-105"></a><span class="in">```</span></span>
<span id="cb24-106"><a href="#cb24-106"></a></span>
<span id="cb24-107"><a href="#cb24-107"></a>Now here's an example where the checks would help to identify future possible</span>
<span id="cb24-108"><a href="#cb24-108"></a>eSubmission challenges. Note the console messages explaining the issues.</span>
<span id="cb24-109"><a href="#cb24-109"></a></span>
<span id="cb24-110"><a href="#cb24-110"></a><span class="in">```{r challenges}</span></span>
<span id="cb24-111"><a href="#cb24-111"></a><span class="in">adsl_challenges &lt;- pharmaverseadam::adsl %&gt;%</span></span>
<span id="cb24-112"><a href="#cb24-112"></a><span class="in">  # Make a numeric variable as character, which conflicts with specifications</span></span>
<span id="cb24-113"><a href="#cb24-113"></a><span class="in">  mutate(AGE = as.character(AGE)) %&gt;%</span></span>
<span id="cb24-114"><a href="#cb24-114"></a><span class="in">  # Add a variable that is name &gt;8 characters which is not allowed for xpt v5</span></span>
<span id="cb24-115"><a href="#cb24-115"></a><span class="in">  mutate(REGIONCAT = REGION1)</span></span>
<span id="cb24-116"><a href="#cb24-116"></a></span>
<span id="cb24-117"><a href="#cb24-117"></a><span class="in">adsl_challenges &lt;- adsl_challenges %&gt;%</span></span>
<span id="cb24-118"><a href="#cb24-118"></a><span class="in">  # Coerce variable type to match specification</span></span>
<span id="cb24-119"><a href="#cb24-119"></a><span class="in">  # This time we use the verbose argument to add a warning to the console</span></span>
<span id="cb24-120"><a href="#cb24-120"></a><span class="in">  xportr_type(metacore, verbose = "warn") %&gt;%</span></span>
<span id="cb24-121"><a href="#cb24-121"></a><span class="in">  # Write xpt v5 transport file</span></span>
<span id="cb24-122"><a href="#cb24-122"></a><span class="in">  xportr_write(file.path(dir, "adsl.xpt"), metadata = metacore, domain = "ADSL")</span></span>
<span id="cb24-123"><a href="#cb24-123"></a><span class="in">```</span></span>
<span id="cb24-124"><a href="#cb24-124"></a></span>
<span id="cb24-125"><a href="#cb24-125"></a>Furthermore, the package functions also include certain arguments that you can</span>
<span id="cb24-126"><a href="#cb24-126"></a>use to help shape to your specific submission needs.</span>
<span id="cb24-127"><a href="#cb24-127"></a></span>
<span id="cb24-128"><a href="#cb24-128"></a>The below shows how some specific FDA requirements can be achieved using</span>
<span id="cb24-129"><a href="#cb24-129"></a>the <span class="in">`length_source`</span> argument from <span class="in">`xportr::xportr_length()`</span> and the</span>
<span id="cb24-130"><a href="#cb24-130"></a><span class="in">`max_size_gb`</span> argument from <span class="in">`xportr::xportr_write()`</span>, as detailed in the code comments.</span>
<span id="cb24-131"><a href="#cb24-131"></a>In this case, the dataset splits would be very unlikely to occur in practice for</span>
<span id="cb24-132"><a href="#cb24-132"></a><span class="in">`ADSL`</span> but would be much more likely on a BDS dataset such as <span class="in">`ADLB`</span> for a</span>
<span id="cb24-133"><a href="#cb24-133"></a>large study.</span>
<span id="cb24-134"><a href="#cb24-134"></a></span>
<span id="cb24-135"><a href="#cb24-135"></a><span class="in">```{r examples}</span></span>
<span id="cb24-136"><a href="#cb24-136"></a><span class="in">adsl_example &lt;- pharmaverseadam::adsl %&gt;%</span></span>
<span id="cb24-137"><a href="#cb24-137"></a><span class="in">  # Coerce variable type to match specification</span></span>
<span id="cb24-138"><a href="#cb24-138"></a><span class="in">  xportr_type(metacore) %&gt;%</span></span>
<span id="cb24-139"><a href="#cb24-139"></a><span class="in">  # Assigns variable label from metacore specifications</span></span>
<span id="cb24-140"><a href="#cb24-140"></a><span class="in">  xportr_label(metacore) %&gt;%</span></span>
<span id="cb24-141"><a href="#cb24-141"></a><span class="in">  # Assigns dataset label from metacore specifications</span></span>
<span id="cb24-142"><a href="#cb24-142"></a><span class="in">  xportr_df_label(metacore) %&gt;%</span></span>
<span id="cb24-143"><a href="#cb24-143"></a><span class="in">  # Assigns length from the maximum length of any value of the variable as per FDA data minimisation guidance</span></span>
<span id="cb24-144"><a href="#cb24-144"></a><span class="in">  xportr_length(metadata = metacore, length_source = "data") %&gt;%</span></span>
<span id="cb24-145"><a href="#cb24-145"></a><span class="in">  # Assigns variable format from metacore specifications</span></span>
<span id="cb24-146"><a href="#cb24-146"></a><span class="in">  xportr_format(metadata = metacore) %&gt;%</span></span>
<span id="cb24-147"><a href="#cb24-147"></a><span class="in">  # Write xpt v5 transport file but split into smaller subsets if greater than 5GB</span></span>
<span id="cb24-148"><a href="#cb24-148"></a><span class="in">  # according to the FDA cutoff size</span></span>
<span id="cb24-149"><a href="#cb24-149"></a><span class="in">  xportr_write(file.path(dir, "adsl.xpt"), metadata = metacore, domain = "ADSL", max_size_gb = 5)</span></span>
<span id="cb24-150"><a href="#cb24-150"></a><span class="in">```</span></span>
<span id="cb24-151"><a href="#cb24-151"></a></span>
<span id="cb24-152"><a href="#cb24-152"></a>As an alternative to xpt, we also have <span class="in">`{datasetjson}`</span> which enables the</span>
<span id="cb24-153"><a href="#cb24-153"></a>emerging new submission data exchange standard Dataset-JSON detailed</span>
<span id="cb24-154"><a href="#cb24-154"></a><span class="co">[</span><span class="ot">here</span><span class="co">](https://www.cdisc.org/standards/data-exchange/dataset-json)</span>. As this</span>
<span id="cb24-155"><a href="#cb24-155"></a>package is still experimental, we don't include code examples here but over time</span>
<span id="cb24-156"><a href="#cb24-156"></a>and as momentum grows we can add extra examples to this article.</span>
<span id="cb24-157"><a href="#cb24-157"></a>See R Submissions WG <span class="co">[</span><span class="ot">pilot 5</span><span class="co">](https://rconsortium.github.io/submissions-pilot5-website/)</span></span>
<span id="cb24-158"><a href="#cb24-158"></a>for a pilot submission using Dataset-JSON.</span>
<span id="cb24-159"><a href="#cb24-159"></a></span>
<span id="cb24-160"><a href="#cb24-160"></a><span class="fu">### Readable Code</span></span>
<span id="cb24-161"><a href="#cb24-161"></a></span>
<span id="cb24-162"><a href="#cb24-162"></a>When using internal company-specific closed source tools and codebases, we</span>
<span id="cb24-163"><a href="#cb24-163"></a>often face challenges around providing readable code to health authorities as</span>
<span id="cb24-164"><a href="#cb24-164"></a>internal single company solutions are by nature not easily accessible and understandable.</span>
<span id="cb24-165"><a href="#cb24-165"></a>This is one of the benefits of using open source codebases in the submission</span>
<span id="cb24-166"><a href="#cb24-166"></a>setting as it enables review teams to look deeper into the functions used, plus</span>
<span id="cb24-167"><a href="#cb24-167"></a>they have the same open solutions available to use themselves as part of their</span>
<span id="cb24-168"><a href="#cb24-168"></a>review. As more of the industry embraces open source, we may even see more</span>
<span id="cb24-169"><a href="#cb24-169"></a>harmonization of submission packages across the industry as the same packages</span>
<span id="cb24-170"><a href="#cb24-170"></a>are re-used, and this should lead to greater familiarity from review teams</span>
<span id="cb24-171"><a href="#cb24-171"></a>easing their critical submission dossier review.</span>
<span id="cb24-172"><a href="#cb24-172"></a></span>
<span id="cb24-173"><a href="#cb24-173"></a>The nature of R packages and functions, as well as influence from <span class="in">`{tidyverse}`</span>,</span>
<span id="cb24-174"><a href="#cb24-174"></a>has encouraged most pharmaverse package development teams to embrace modular</span>
<span id="cb24-175"><a href="#cb24-175"></a>strategy to their code. So when you use packages like <span class="in">`{admiral}`</span>, you'll see</span>
<span id="cb24-176"><a href="#cb24-176"></a>that the ADaM templates have been built with readability in mind specifically to</span>
<span id="cb24-177"><a href="#cb24-177"></a>aid with eSubmission.</span>
<span id="cb24-178"><a href="#cb24-178"></a></span>
<span id="cb24-179"><a href="#cb24-179"></a><span class="fu">### Documentation</span></span>
<span id="cb24-180"><a href="#cb24-180"></a></span>
<span id="cb24-181"><a href="#cb24-181"></a>When using R for submission there are some important recommendations around</span>
<span id="cb24-182"><a href="#cb24-182"></a>documentation you should include as part of the eSubmission package. Most</span>
<span id="cb24-183"><a href="#cb24-183"></a>companies include these in the Reviewer's Guide documents (_the PHUSE Advance Hub</span>
<span id="cb24-184"><a href="#cb24-184"></a>offers example templates for these_), but you might also choose to use a</span>
<span id="cb24-185"><a href="#cb24-185"></a>programTOC document.</span>
<span id="cb24-186"><a href="#cb24-186"></a></span>
<span id="cb24-187"><a href="#cb24-187"></a>Here's the information we recommend including:</span>
<span id="cb24-188"><a href="#cb24-188"></a></span>
<span id="cb24-189"><a href="#cb24-189"></a><span class="ss">- </span>R version used</span>
<span id="cb24-190"><a href="#cb24-190"></a><span class="ss">- </span>Descriptions of the main open source R package used, the version of each that</span>
<span id="cb24-191"><a href="#cb24-191"></a>you used, and where these are available from (especially if anywhere other than CRAN)</span>
<span id="cb24-192"><a href="#cb24-192"></a><span class="ss">- </span>Descriptions of any closed source packages used (see details below)</span>
<span id="cb24-193"><a href="#cb24-193"></a><span class="ss">- </span>Basic installation instructions of the R version used and how to install the</span>
<span id="cb24-194"><a href="#cb24-194"></a>package versions that you used (e.g. from CRAN). The R installation instructions</span>
<span id="cb24-195"><a href="#cb24-195"></a>should cover installation from Windows.</span>
<span id="cb24-196"><a href="#cb24-196"></a></span>
<span id="cb24-197"><a href="#cb24-197"></a>Here is an example extract of what the documentation of the open source packages</span>
<span id="cb24-198"><a href="#cb24-198"></a>used might look like:</span>
<span id="cb24-199"><a href="#cb24-199"></a></span>
<span id="cb24-200"><a href="#cb24-200"></a><span class="al">![Example Reviewer's Guide Table](ADRG.png)</span>{fig-align="center"}</span>
<span id="cb24-201"><a href="#cb24-201"></a></span>
<span id="cb24-202"><a href="#cb24-202"></a>For closed source packages, if you plan to submit the code then there are 2 main</span>
<span id="cb24-203"><a href="#cb24-203"></a>options - <span class="in">`{pkglite}`</span> to create txt files, or zip files (as were successfully</span>
<span id="cb24-204"><a href="#cb24-204"></a>used in later R Submission WG pilots).</span>
<span id="cb24-205"><a href="#cb24-205"></a></span>
<span id="cb24-206"><a href="#cb24-206"></a>Here is an example taken from the R Submission WG pilot 1 around how they used</span>
<span id="cb24-207"><a href="#cb24-207"></a><span class="in">`pkglite::pack()`</span> to provide packages as txt files. On the other side</span>
<span id="cb24-208"><a href="#cb24-208"></a><span class="in">`pkglite::unpack()`</span> could then be used to unpack.</span>
<span id="cb24-209"><a href="#cb24-209"></a></span>
<span id="cb24-210"><a href="#cb24-210"></a><span class="in">```{r pack, eval=FALSE}</span></span>
<span id="cb24-211"><a href="#cb24-211"></a><span class="in">library(pkglite)</span></span>
<span id="cb24-212"><a href="#cb24-212"></a></span>
<span id="cb24-213"><a href="#cb24-213"></a><span class="in"># Using pkglite to pack proprietary R package and saved into ectd/r0pkg.txt</span></span>
<span id="cb24-214"><a href="#cb24-214"></a><span class="in">path$home %&gt;%</span></span>
<span id="cb24-215"><a href="#cb24-215"></a><span class="in">  collate(file_ectd(), file_auto("inst")) %&gt;%</span></span>
<span id="cb24-216"><a href="#cb24-216"></a><span class="in">  prune("R/zzz.R") %&gt;%</span></span>
<span id="cb24-217"><a href="#cb24-217"></a><span class="in">  pack(output = "ectd/r0pkg.txt")</span></span>
<span id="cb24-218"><a href="#cb24-218"></a><span class="in">```</span></span>
<span id="cb24-219"><a href="#cb24-219"></a></span>
<span id="cb24-220"><a href="#cb24-220"></a>You can also check the following example Reviewer's Guides as used for these pilots:</span>
<span id="cb24-221"><a href="#cb24-221"></a></span>
<span id="cb24-222"><a href="#cb24-222"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Pilot 1</span><span class="co">](https://github.com/RConsortium/submissions-pilot1-to-fda/blob/main/m5/datasets/rconsortiumpilot1/analysis/adam/datasets/adrg.pdf)</span>,</span>
<span id="cb24-223"><a href="#cb24-223"></a>using <span class="in">`{pkglite}`</span></span>
<span id="cb24-224"><a href="#cb24-224"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Pilot 3</span><span class="co">](https://github.com/RConsortium/submissions-pilot3-adam-to-fda/blob/main/m5/datasets/rconsortiumpilot3/analysis/adam/datasets/adrg.pdf)</span>,</span>
<span id="cb24-225"><a href="#cb24-225"></a>using compressed .zip approach</span>
<span id="cb24-226"><a href="#cb24-226"></a></span>
<span id="cb24-227"><a href="#cb24-227"></a>For further Reviewer's Guide guidance, regardless of the programming language used for</span>
<span id="cb24-228"><a href="#cb24-228"></a>regulatory submissions, refer to the completion guidelines found at this</span>
<span id="cb24-229"><a href="#cb24-229"></a><span class="co">[</span><span class="ot">PHUSE ADRG Package WG</span><span class="co">](https://advance.hub.phuse.global/wiki/spaces/WEL/pages/26804660/Analysis+Data+Reviewer+s+Guide+ADRG+Package)</span>.</span>
<span id="cb24-230"><a href="#cb24-230"></a>As we progress on this open source submission journey, it is worth monitoring this</span>
<span id="cb24-231"><a href="#cb24-231"></a><span class="co">[</span><span class="ot">PHUSE Open-Source Metadata Documentation WG</span><span class="co">](https://phuse-org.github.io/OSDocuMeta/)</span></span>
<span id="cb24-232"><a href="#cb24-232"></a>to see how the guidance continues to evolve in this space.</span>
<span id="cb24-233"><a href="#cb24-233"></a></span>
<span id="cb24-234"><a href="#cb24-234"></a><span class="fu">### Validation</span></span>
<span id="cb24-235"><a href="#cb24-235"></a></span>
<span id="cb24-236"><a href="#cb24-236"></a>Last but not least, through the submission process you might be asked to</span>
<span id="cb24-237"><a href="#cb24-237"></a>provide evidence of why you consider the open source code used to be accurate</span>
<span id="cb24-238"><a href="#cb24-238"></a>and reliable.</span>
<span id="cb24-239"><a href="#cb24-239"></a></span>
<span id="cb24-240"><a href="#cb24-240"></a>This of course is a huge topic and one where you should first refer to</span>
<span id="cb24-241"><a href="#cb24-241"></a>guidance from the <span class="co">[</span><span class="ot">R Validation Hub</span><span class="co">](https://www.pharmar.org/)</span>.</span>
<span id="cb24-242"><a href="#cb24-242"></a></span>
<span id="cb24-243"><a href="#cb24-243"></a>Pharmaverse also offers a selection of recommended packages that can help with</span>
<span id="cb24-244"><a href="#cb24-244"></a>this via our <span class="co">[</span><span class="ot">Developers page</span><span class="co">](https://pharmaverse.org/e2eclinical/developers/)</span></span>
<span id="cb24-245"><a href="#cb24-245"></a>under Package Validation. Under CI/CD it also offers <span class="in">`thevalidatoR`</span> which is a GitHub</span>
<span id="cb24-246"><a href="#cb24-246"></a>action that can be used to produce standardised validation reports, such as this</span>
<span id="cb24-247"><a href="#cb24-247"></a><span class="co">[</span><span class="ot">example</span><span class="co">](https://github.com/insightsengineering/thevalidatoR/blob/main/readme_files/report-0.1-admiral.pdf)</span></span>
<span id="cb24-248"><a href="#cb24-248"></a>from an earlier version of <span class="in">`{admiral}`</span>.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>